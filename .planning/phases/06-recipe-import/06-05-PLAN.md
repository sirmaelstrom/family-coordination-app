---
phase: 06-recipe-import
plan: 05
type: execute
wave: 3
depends_on: [06-03]
files_modified:
  - src/FamilyCoordinationApp/Components/Recipe/RecipeCard.razor
  - src/FamilyCoordinationApp/Components/Pages/Recipes.razor
autonomous: true

must_haves:
  truths:
    - "Imported recipes show source indicator (link icon or badge)"
    - "Source URL is clickable to view original recipe"
    - "Indicator appears in recipe list and expanded view"
  artifacts:
    - path: "src/FamilyCoordinationApp/Components/Recipe/RecipeCard.razor"
      provides: "Import indicator with clickable source link"
      contains: "SourceUrl"
  key_links:
    - from: "RecipeCard"
      to: "Recipe.SourceUrl"
      via: "conditional rendering"
      pattern: "SourceUrl"
---

<objective>
Add visual indicator for imported recipes showing their source URL with a clickable link.

Purpose: Users can distinguish imported recipes from manually created ones and access the original source.
Output: Recipe cards display import indicator with source link.
</objective>

<execution_context>
@/home/[USER]/.claude/get-shit-done/workflows/execute-plan.md
@/home/[USER]/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-recipe-import/06-03-SUMMARY.md
@src/FamilyCoordinationApp/Components/Recipe/RecipeCard.razor
@src/FamilyCoordinationApp/Data/Entities/Recipe.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add import source indicator to RecipeCard collapsed view</name>
  <files>src/FamilyCoordinationApp/Components/Recipe/RecipeCard.razor</files>
  <action>
Update RecipeCard.razor to show an indicator when recipe has SourceUrl.

In the collapsed card view (the always-visible part), add an import indicator near the recipe name or metadata:

```razor
@* Add near the recipe name or in the card subtitle area *@
@if (!string.IsNullOrWhiteSpace(Recipe.SourceUrl))
{
    <MudTooltip Text="Imported from web">
        <MudIcon Icon="@Icons.Material.Filled.CloudDownload"
                 Size="Size.Small"
                 Color="Color.Secondary"
                 Class="ml-2" />
    </MudTooltip>
}
```

This should appear in the collapsed card header, near the recipe title or creator info.
  </action>
  <verify>File compiles, `dotnet build` passes</verify>
  <done>Collapsed recipe card shows import indicator (cloud download icon)</done>
</task>

<task type="auto">
  <name>Task 2: Add source link to RecipeCard expanded view</name>
  <files>src/FamilyCoordinationApp/Components/Recipe/RecipeCard.razor</files>
  <action>
In the expanded card view (when card is clicked/expanded), add a clickable source link:

```razor
@* Add in the expanded details section, perhaps near description or at the bottom *@
@if (!string.IsNullOrWhiteSpace(Recipe.SourceUrl))
{
    <div class="d-flex align-center mt-3">
        <MudIcon Icon="@Icons.Material.Filled.Link" Size="Size.Small" Class="mr-2" />
        <MudLink Href="@Recipe.SourceUrl"
                 Target="_blank"
                 Rel="noopener noreferrer"
                 Color="Color.Secondary"
                 Typo="Typo.body2">
            View Original Recipe
        </MudLink>
    </div>
}
```

This gives users a way to reference the original recipe page.
  </action>
  <verify>File compiles, `dotnet build` passes</verify>
  <done>Expanded recipe card shows clickable source link</done>
</task>

<task type="auto">
  <name>Task 3: Add source link to RecipeEdit page</name>
  <files>src/FamilyCoordinationApp/Components/Pages/RecipeEdit.razor</files>
  <action>
In RecipeEdit.razor, show the source URL if the recipe was imported. Add in the Basic Info section or a separate info area:

```razor
@* Add after the basic info section header, conditionally *@
@if (!string.IsNullOrWhiteSpace(_recipe.SourceUrl))
{
    <MudAlert Severity="Severity.Info" Class="mb-4" Dense="true">
        <div class="d-flex align-center">
            <MudIcon Icon="@Icons.Material.Filled.CloudDownload" Size="Size.Small" Class="mr-2" />
            <MudText Typo="Typo.body2">
                Imported from
                <MudLink Href="@_recipe.SourceUrl"
                         Target="_blank"
                         Rel="noopener noreferrer"
                         Color="Color.Inherit">
                    @GetDomainFromUrl(_recipe.SourceUrl)
                </MudLink>
            </MudText>
        </div>
    </MudAlert>
}
```

Add helper method in @code section:

```csharp
private static string GetDomainFromUrl(string url)
{
    try
    {
        var uri = new Uri(url);
        return uri.Host.Replace("www.", "");
    }
    catch
    {
        return url;
    }
}
```

This shows users where the recipe was imported from and allows them to reference the original.
  </action>
  <verify>File compiles, `dotnet build` passes</verify>
  <done>RecipeEdit page shows source URL with domain for imported recipes</done>
</task>

</tasks>

<verification>
1. `dotnet build src/FamilyCoordinationApp` - No compilation errors
2. grep -q "SourceUrl" src/FamilyCoordinationApp/Components/Recipe/RecipeCard.razor (indicator)
3. grep -q "View Original Recipe" src/FamilyCoordinationApp/Components/Recipe/RecipeCard.razor (link text)
4. grep -q "Imported from" src/FamilyCoordinationApp/Components/Pages/RecipeEdit.razor (edit page indicator)
5. grep -q "noopener noreferrer" - security attribute on external links
</verification>

<success_criteria>
- Collapsed recipe cards show cloud download icon for imported recipes
- Expanded recipe cards show "View Original Recipe" link
- RecipeEdit page shows source domain in info alert
- External links open in new tab with security attributes
- Solution builds successfully
</success_criteria>

<output>
After completion, create `.planning/phases/06-recipe-import/06-05-SUMMARY.md`
</output>
