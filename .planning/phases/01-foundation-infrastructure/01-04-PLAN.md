---
phase: 01-foundation-infrastructure
plan: 04
type: execute
wave: 3
depends_on: ["01-02", "01-03"]
files_modified:
  - src/FamilyCoordinationApp/Program.cs
  - src/FamilyCoordinationApp/Data/SeedData.cs
  - src/FamilyCoordinationApp/Components/Pages/Setup/FirstRunSetup.razor
  - src/FamilyCoordinationApp/Components/Pages/Settings/WhitelistAdmin.razor
  - src/FamilyCoordinationApp/Components/Pages/Home.razor
  - src/FamilyCoordinationApp/Services/SetupService.cs
autonomous: true

must_haves:
  truths:
    - "First-time visitor sees setup wizard to create household and initial user"
    - "Setup wizard creates household with name and first whitelisted user"
    - "Authenticated users can access whitelist admin page"
    - "Any whitelisted user can add or remove other users from whitelist"
    - "Development seed data creates realistic sample recipes and meal plans"
  artifacts:
    - path: "src/FamilyCoordinationApp/Components/Pages/Setup/FirstRunSetup.razor"
      provides: "Setup wizard for first-time configuration"
      contains: "CreateHousehold"
    - path: "src/FamilyCoordinationApp/Components/Pages/Settings/WhitelistAdmin.razor"
      provides: "Admin UI for managing email whitelist"
      contains: "AddUser"
    - path: "src/FamilyCoordinationApp/Data/SeedData.cs"
      provides: "Development seed data with realistic recipes"
      contains: "Bogus"
    - path: "src/FamilyCoordinationApp/Services/SetupService.cs"
      provides: "Service for checking and completing first-run setup"
      exports: ["SetupService", "IsSetupComplete", "CreateHousehold"]
  key_links:
    - from: "Program.cs"
      to: "SetupService"
      via: "Middleware that redirects to setup if needed"
      pattern: "SetupService.*IsSetupComplete"
    - from: "FirstRunSetup.razor"
      to: "SetupService"
      via: "CreateHousehold call"
      pattern: "CreateHousehold"
    - from: "SeedData.cs"
      to: "Bogus"
      via: "Faker for realistic data"
      pattern: "Faker<Recipe>"
---

<objective>
Create first-run setup wizard, whitelist admin UI, and development seed data.

Purpose: The app needs initial configuration (household name, first user) before use. The whitelist admin lets any family member add others. Seed data provides realistic test data for development and demos.

Output: Working setup flow for new installations, admin page for user management, and seed data that creates sample recipes, meal plans, and shopping lists.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-infrastructure/01-RESEARCH.md
@.planning/phases/01-foundation-infrastructure/01-CONTEXT.md
@.planning/phases/01-foundation-infrastructure/01-01-SUMMARY.md
@.planning/phases/01-foundation-infrastructure/01-02-SUMMARY.md
@.planning/phases/01-foundation-infrastructure/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SetupService and first-run middleware</name>
  <files>
    src/FamilyCoordinationApp/Services/SetupService.cs
    src/FamilyCoordinationApp/Program.cs
  </files>
  <action>
Create Services/ directory and SetupService for first-run detection and setup.

**Services/SetupService.cs**:
```csharp
using Microsoft.EntityFrameworkCore;
using FamilyCoordinationApp.Data;
using FamilyCoordinationApp.Data.Entities;

namespace FamilyCoordinationApp.Services;

public class SetupService
{
    private readonly IDbContextFactory<ApplicationDbContext> _dbFactory;
    private readonly ILogger<SetupService> _logger;

    // Cache setup status (reset on household creation)
    private bool? _isSetupComplete;

    public SetupService(
        IDbContextFactory<ApplicationDbContext> dbFactory,
        ILogger<SetupService> logger)
    {
        _dbFactory = dbFactory;
        _logger = logger;
    }

    public async Task<bool> IsSetupCompleteAsync()
    {
        if (_isSetupComplete.HasValue)
            return _isSetupComplete.Value;

        try
        {
            using var context = _dbFactory.CreateDbContext();

            // Ensure database exists and is migrated
            await context.Database.MigrateAsync();

            // Setup is complete if at least one household exists
            _isSetupComplete = await context.Households.AnyAsync();
            return _isSetupComplete.Value;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error checking setup status");
            return false;
        }
    }

    public async Task<(Household household, User user)> CreateHouseholdAsync(
        string householdName,
        string userEmail,
        string displayName,
        string googleId)
    {
        using var context = _dbFactory.CreateDbContext();

        var household = new Household
        {
            Name = householdName,
            CreatedAt = DateTime.UtcNow
        };
        context.Households.Add(household);
        await context.SaveChangesAsync();

        var user = new User
        {
            HouseholdId = household.Id,
            Email = userEmail,
            DisplayName = displayName,
            GoogleId = googleId,
            IsWhitelisted = true,
            CreatedAt = DateTime.UtcNow,
            LastLoginAt = DateTime.UtcNow
        };
        context.Users.Add(user);
        await context.SaveChangesAsync();

        // Reset cache
        _isSetupComplete = true;

        _logger.LogInformation(
            "Created household '{HouseholdName}' with initial user {Email}",
            householdName, userEmail);

        return (household, user);
    }

    public async Task<Household?> GetHouseholdAsync()
    {
        using var context = _dbFactory.CreateDbContext();
        return await context.Households.FirstOrDefaultAsync();
    }

    public async Task<User?> GetUserByEmailAsync(string email)
    {
        using var context = _dbFactory.CreateDbContext();
        return await context.Users
            .Include(u => u.Household)
            .FirstOrDefaultAsync(u => u.Email == email);
    }
}
```

**Program.cs additions** (register service and add middleware):

After DbContextFactory registration:
```csharp
builder.Services.AddScoped<SetupService>();
```

Add middleware after UseAuthorization (creates a simple redirect check):
```csharp
// First-run setup redirect middleware
app.Use(async (context, next) =>
{
    var path = context.Request.Path.Value?.ToLowerInvariant() ?? "";

    // Skip setup check for these paths
    if (path.StartsWith("/setup") ||
        path.StartsWith("/account") ||
        path.StartsWith("/_") ||
        path.StartsWith("/health") ||
        path.Contains("."))
    {
        await next();
        return;
    }

    var setupService = context.RequestServices.GetRequiredService<SetupService>();
    if (!await setupService.IsSetupCompleteAsync())
    {
        context.Response.Redirect("/setup");
        return;
    }

    await next();
});
```

Why middleware approach: Ensures ALL requests check setup status before proceeding. Cleaner than checking in every page.
  </action>
  <verify>
```bash
cd /home/sirm/projects/github/family-coordination-app/src/FamilyCoordinationApp
dotnet build
ls Services/SetupService.cs
grep "SetupService" Program.cs
```
Build succeeds, SetupService exists, registered in Program.cs.
  </verify>
  <done>SetupService created with IsSetupCompleteAsync and CreateHouseholdAsync. Middleware redirects to /setup if no household exists.</done>
</task>

<task type="auto">
  <name>Task 2: Create first-run setup wizard page</name>
  <files>
    src/FamilyCoordinationApp/Components/Pages/Setup/FirstRunSetup.razor
  </files>
  <action>
Create Components/Pages/Setup/ directory and setup wizard.

**FirstRunSetup.razor**:
```razor
@page "/setup"
@attribute [AllowAnonymous]
@using System.Security.Claims
@using FamilyCoordinationApp.Services
@inject SetupService SetupService
@inject NavigationManager Navigation
@inject IHttpContextAccessor HttpContextAccessor

<PageTitle>Welcome - Family Coordination Setup</PageTitle>

<div class="min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4">
    <div class="max-w-md w-full space-y-8">
        <div class="text-center">
            <h1 class="text-3xl font-bold text-gray-900">Welcome to Family Coordination</h1>
            <p class="mt-2 text-gray-600">Let's set up your household</p>
        </div>

        @if (_isAlreadySetup)
        {
            <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
                <p class="text-green-800">Setup is already complete!</p>
                <a href="/" class="mt-4 inline-block px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">
                    Go to Home
                </a>
            </div>
        }
        else if (!_isAuthenticated)
        {
            <div class="bg-white py-8 px-4 shadow rounded-lg">
                <p class="text-center text-gray-600 mb-6">
                    First, sign in with Google to create your household.
                </p>
                <form method="post" action="/account/login-google">
                    <input type="hidden" name="returnUrl" value="/setup" />
                    <button type="submit"
                            class="w-full flex justify-center items-center gap-3 py-3 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-gray-700 hover:bg-gray-50">
                        <svg class="w-5 h-5" viewBox="0 0 24 24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                        Sign in with Google
                    </button>
                </form>
            </div>
        }
        else
        {
            <div class="bg-white py-8 px-6 shadow rounded-lg">
                <form @onsubmit="HandleSetup" @onsubmit:preventDefault>
                    <div class="space-y-6">
                        <div>
                            <p class="text-sm text-gray-600 mb-4">
                                Signed in as <strong>@_userEmail</strong>
                            </p>
                        </div>

                        <div>
                            <label for="householdName" class="block text-sm font-medium text-gray-700">
                                Household Name
                            </label>
                            <input type="text"
                                   id="householdName"
                                   @bind="_householdName"
                                   placeholder="The Smith Family"
                                   required
                                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" />
                            <p class="mt-1 text-sm text-gray-500">
                                This name will appear throughout the app.
                            </p>
                        </div>

                        @if (!string.IsNullOrEmpty(_errorMessage))
                        {
                            <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                                <p class="text-sm text-red-600">@_errorMessage</p>
                            </div>
                        }

                        <button type="submit"
                                disabled="@_isSubmitting"
                                class="w-full py-3 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed">
                            @if (_isSubmitting)
                            {
                                <span>Creating household...</span>
                            }
                            else
                            {
                                <span>Create Household</span>
                            }
                        </button>
                    </div>
                </form>
            </div>
        }
    </div>
</div>

@code {
    private bool _isAlreadySetup;
    private bool _isAuthenticated;
    private string _userEmail = "";
    private string _userName = "";
    private string _googleId = "";
    private string _householdName = "";
    private string _errorMessage = "";
    private bool _isSubmitting;

    protected override async Task OnInitializedAsync()
    {
        _isAlreadySetup = await SetupService.IsSetupCompleteAsync();

        if (_isAlreadySetup)
            return;

        var user = HttpContextAccessor.HttpContext?.User;
        _isAuthenticated = user?.Identity?.IsAuthenticated == true;

        if (_isAuthenticated)
        {
            _userEmail = user!.FindFirst(ClaimTypes.Email)?.Value ?? "";
            _userName = user.FindFirst(ClaimTypes.Name)?.Value ?? _userEmail;
            _googleId = user.FindFirst(ClaimTypes.NameIdentifier)?.Value ?? "";
        }
    }

    private async Task HandleSetup()
    {
        if (string.IsNullOrWhiteSpace(_householdName))
        {
            _errorMessage = "Please enter a household name.";
            return;
        }

        _isSubmitting = true;
        _errorMessage = "";

        try
        {
            await SetupService.CreateHouseholdAsync(
                _householdName.Trim(),
                _userEmail,
                _userName,
                _googleId);

            // Redirect to home after successful setup
            Navigation.NavigateTo("/", forceLoad: true);
        }
        catch (Exception ex)
        {
            _errorMessage = "Failed to create household. Please try again.";
            _isSubmitting = false;
        }
    }
}
```

Key UX decisions:
- Step 1: User signs in with Google (if not already)
- Step 2: User enters household name
- First signed-in user becomes first whitelisted member automatically
  </action>
  <verify>
```bash
cd /home/sirm/projects/github/family-coordination-app/src/FamilyCoordinationApp
dotnet build
ls Components/Pages/Setup/FirstRunSetup.razor
```
Build succeeds, setup page exists.
  </verify>
  <done>First-run setup wizard created. Requires Google auth, then creates household with first user auto-whitelisted.</done>
</task>

<task type="auto">
  <name>Task 3: Create whitelist admin page and update Home page</name>
  <files>
    src/FamilyCoordinationApp/Components/Pages/Settings/WhitelistAdmin.razor
    src/FamilyCoordinationApp/Components/Pages/Home.razor
    src/FamilyCoordinationApp/Data/SeedData.cs
  </files>
  <action>
Create Settings/WhitelistAdmin.razor for user management and update Home.razor.

**Components/Pages/Settings/WhitelistAdmin.razor**:
```razor
@page "/settings/users"
@attribute [Authorize]
@using Microsoft.EntityFrameworkCore
@using FamilyCoordinationApp.Data
@using FamilyCoordinationApp.Data.Entities
@inject IDbContextFactory<ApplicationDbContext> DbFactory
@implements IAsyncDisposable

<PageTitle>Manage Users - Family Coordination</PageTitle>

<div class="max-w-2xl mx-auto py-8 px-4">
    <h1 class="text-2xl font-bold text-gray-900 mb-6">Manage Family Members</h1>

    @if (_isLoading)
    {
        <p class="text-gray-600">Loading...</p>
    }
    else
    {
        <!-- Add new user form -->
        <div class="bg-white shadow rounded-lg p-6 mb-6">
            <h2 class="text-lg font-medium text-gray-900 mb-4">Add Family Member</h2>
            <form @onsubmit="AddUser" @onsubmit:preventDefault class="flex gap-4">
                <input type="email"
                       @bind="_newEmail"
                       placeholder="email@example.com"
                       required
                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" />
                <button type="submit"
                        disabled="@_isSubmitting"
                        class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50">
                    Add
                </button>
            </form>
            @if (!string.IsNullOrEmpty(_message))
            {
                <p class="mt-2 text-sm @(_isError ? "text-red-600" : "text-green-600")">@_message</p>
            }
        </div>

        <!-- Current users list -->
        <div class="bg-white shadow rounded-lg overflow-hidden">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Email</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Actions</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    @foreach (var user in _users)
                    {
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">@user.Email</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">@user.DisplayName</td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                @if (user.IsWhitelisted)
                                {
                                    <span class="px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full">Active</span>
                                }
                                else
                                {
                                    <span class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full">Disabled</span>
                                }
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-right text-sm">
                                @if (user.IsWhitelisted && _users.Count(u => u.IsWhitelisted) > 1)
                                {
                                    <button @onclick="() => ToggleUser(user)"
                                            class="text-red-600 hover:text-red-900">
                                        Disable
                                    </button>
                                }
                                else if (!user.IsWhitelisted)
                                {
                                    <button @onclick="() => ToggleUser(user)"
                                            class="text-green-600 hover:text-green-900">
                                        Enable
                                    </button>
                                }
                                else
                                {
                                    <span class="text-gray-400">Last admin</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>

@code {
    private ApplicationDbContext _context = default!;
    private List<User> _users = new();
    private string _newEmail = "";
    private string _message = "";
    private bool _isError;
    private bool _isLoading = true;
    private bool _isSubmitting;
    private int _householdId;

    protected override async Task OnInitializedAsync()
    {
        _context = DbFactory.CreateDbContext();
        await LoadUsers();
    }

    private async Task LoadUsers()
    {
        _isLoading = true;
        var household = await _context.Households.FirstOrDefaultAsync();
        if (household != null)
        {
            _householdId = household.Id;
            _users = await _context.Users
                .Where(u => u.HouseholdId == _householdId)
                .OrderBy(u => u.Email)
                .ToListAsync();
        }
        _isLoading = false;
    }

    private async Task AddUser()
    {
        if (string.IsNullOrWhiteSpace(_newEmail))
            return;

        _isSubmitting = true;
        _message = "";

        try
        {
            var email = _newEmail.Trim().ToLowerInvariant();

            // Check if user already exists
            var existingUser = await _context.Users
                .FirstOrDefaultAsync(u => u.Email == email);

            if (existingUser != null)
            {
                if (!existingUser.IsWhitelisted)
                {
                    existingUser.IsWhitelisted = true;
                    await _context.SaveChangesAsync();
                    _message = $"Re-enabled {email}";
                    _isError = false;
                }
                else
                {
                    _message = "User already has access.";
                    _isError = true;
                }
            }
            else
            {
                var newUser = new User
                {
                    HouseholdId = _householdId,
                    Email = email,
                    DisplayName = email.Split('@')[0],  // Default to email prefix
                    GoogleId = "",  // Will be set on first login
                    IsWhitelisted = true,
                    CreatedAt = DateTime.UtcNow
                };
                _context.Users.Add(newUser);
                await _context.SaveChangesAsync();
                _message = $"Added {email} to whitelist";
                _isError = false;
            }

            _newEmail = "";
            await LoadUsers();
        }
        catch (Exception)
        {
            _message = "Failed to add user. Please try again.";
            _isError = true;
        }
        finally
        {
            _isSubmitting = false;
        }
    }

    private async Task ToggleUser(User user)
    {
        user.IsWhitelisted = !user.IsWhitelisted;
        await _context.SaveChangesAsync();
        _message = user.IsWhitelisted
            ? $"Enabled {user.Email}"
            : $"Disabled {user.Email}";
        _isError = false;
    }

    public async ValueTask DisposeAsync()
    {
        await _context.DisposeAsync();
    }
}
```

**Update Components/Pages/Home.razor** (replace default content):
```razor
@page "/"
@attribute [Authorize]
@using System.Security.Claims
@using FamilyCoordinationApp.Services
@inject SetupService SetupService
@inject IHttpContextAccessor HttpContextAccessor

<PageTitle>Home - Family Coordination</PageTitle>

<div class="max-w-4xl mx-auto py-8 px-4">
    <h1 class="text-3xl font-bold text-gray-900 mb-2">Welcome, @_displayName!</h1>
    <p class="text-gray-600 mb-8">@_householdName</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Quick links - placeholders for future phases -->
        <a href="/recipes" class="block p-6 bg-white rounded-lg shadow hover:shadow-md transition-shadow">
            <h2 class="text-xl font-semibold text-gray-900 mb-2">Recipes</h2>
            <p class="text-gray-600">Browse and manage your family recipes</p>
        </a>

        <a href="/meal-plan" class="block p-6 bg-white rounded-lg shadow hover:shadow-md transition-shadow">
            <h2 class="text-xl font-semibold text-gray-900 mb-2">Meal Plan</h2>
            <p class="text-gray-600">Plan your meals for the week</p>
        </a>

        <a href="/shopping-list" class="block p-6 bg-white rounded-lg shadow hover:shadow-md transition-shadow">
            <h2 class="text-xl font-semibold text-gray-900 mb-2">Shopping List</h2>
            <p class="text-gray-600">View and manage your shopping list</p>
        </a>

        <a href="/settings/users" class="block p-6 bg-white rounded-lg shadow hover:shadow-md transition-shadow">
            <h2 class="text-xl font-semibold text-gray-900 mb-2">Family Members</h2>
            <p class="text-gray-600">Manage who has access to this app</p>
        </a>
    </div>
</div>

@code {
    private string _displayName = "";
    private string _householdName = "";

    protected override async Task OnInitializedAsync()
    {
        var user = HttpContextAccessor.HttpContext?.User;
        _displayName = user?.FindFirst(ClaimTypes.Name)?.Value
            ?? user?.FindFirst(ClaimTypes.Email)?.Value
            ?? "there";

        var household = await SetupService.GetHouseholdAsync();
        _householdName = household?.Name ?? "Your Household";
    }
}
```

**Data/SeedData.cs** (development seed data):
```csharp
using Bogus;
using FamilyCoordinationApp.Data.Entities;
using Microsoft.EntityFrameworkCore;

namespace FamilyCoordinationApp.Data;

public static class SeedData
{
    public static async Task SeedDevelopmentDataAsync(IDbContextFactory<ApplicationDbContext> dbFactory)
    {
        using var context = dbFactory.CreateDbContext();

        // Only seed if no recipes exist
        if (await context.Recipes.AnyAsync())
            return;

        var household = await context.Households.FirstOrDefaultAsync();
        if (household == null)
            return;

        var user = await context.Users.FirstOrDefaultAsync(u => u.HouseholdId == household.Id);
        if (user == null)
            return;

        // Real recipe names for realistic data
        var recipeNames = new[]
        {
            "Spaghetti Bolognese",
            "Chicken Stir Fry",
            "Beef Tacos",
            "Grilled Salmon",
            "Vegetable Curry",
            "Caesar Salad",
            "Mushroom Risotto",
            "BBQ Pulled Pork",
            "Thai Green Curry",
            "Lasagna",
            "Chicken Parmesan",
            "Shrimp Scampi",
            "Beef Stroganoff",
            "Fish and Chips",
            "Pad Thai"
        };

        var categories = new[] { "Meat", "Produce", "Dairy", "Pantry", "Spices" };
        var units = new[] { "lb", "oz", "cup", "tbsp", "tsp", "piece", "clove", "can" };

        var ingredientFaker = new Faker<RecipeIngredient>()
            .RuleFor(i => i.Name, f => f.Commerce.ProductName())
            .RuleFor(i => i.Quantity, f => f.Random.Decimal(0.25m, 4m))
            .RuleFor(i => i.Unit, f => f.PickRandom(units))
            .RuleFor(i => i.Category, f => f.PickRandom(categories))
            .RuleFor(i => i.SortOrder, (f, i) => f.IndexFaker);

        var recipeId = 1;
        foreach (var name in recipeNames)
        {
            var recipe = new Recipe
            {
                HouseholdId = household.Id,
                RecipeId = recipeId++,
                Name = name,
                Description = $"A delicious {name.ToLower()} recipe",
                Instructions = $"1. Prepare ingredients\n2. Cook {name.ToLower()}\n3. Serve hot",
                Servings = new Random().Next(2, 8),
                PrepTimeMinutes = new Random().Next(10, 30),
                CookTimeMinutes = new Random().Next(15, 60),
                CreatedByUserId = user.Id,
                CreatedAt = DateTime.UtcNow.AddDays(-new Random().Next(1, 30))
            };

            // Add 4-8 ingredients per recipe
            var ingredientCount = new Random().Next(4, 9);
            for (int i = 0; i < ingredientCount; i++)
            {
                var ingredient = ingredientFaker.Generate();
                ingredient.HouseholdId = household.Id;
                ingredient.RecipeId = recipe.RecipeId;
                ingredient.IngredientId = i + 1;
                recipe.Ingredients.Add(ingredient);
            }

            context.Recipes.Add(recipe);
        }

        await context.SaveChangesAsync();
    }
}
```

**Add seed data call to Program.cs** (after app.Build(), in development only):
```csharp
// Seed development data
if (app.Environment.IsDevelopment())
{
    using var scope = app.Services.CreateScope();
    var dbFactory = scope.ServiceProvider.GetRequiredService<IDbContextFactory<ApplicationDbContext>>();

    // Ensure database is created/migrated
    using var context = dbFactory.CreateDbContext();
    await context.Database.MigrateAsync();

    await SeedData.SeedDevelopmentDataAsync(dbFactory);
}
```

Add using:
```csharp
using FamilyCoordinationApp.Data;
```
  </action>
  <verify>
```bash
cd /home/sirm/projects/github/family-coordination-app/src/FamilyCoordinationApp
dotnet build
ls Components/Pages/Settings/WhitelistAdmin.razor
ls Components/Pages/Home.razor
ls Data/SeedData.cs
grep "SeedDevelopmentDataAsync" Program.cs
```
Build succeeds, all files exist, seed data called in Program.cs.
  </verify>
  <done>WhitelistAdmin page created for user management. Home page shows dashboard with quick links. SeedData creates realistic sample recipes in development.</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Project builds**:
   ```bash
   cd /home/sirm/projects/github/family-coordination-app/src/FamilyCoordinationApp
   dotnet build
   ```

2. **All pages exist**:
   ```bash
   ls Components/Pages/Setup/FirstRunSetup.razor
   ls Components/Pages/Settings/WhitelistAdmin.razor
   ls Components/Pages/Home.razor
   ```

3. **Services exist**:
   ```bash
   ls Services/SetupService.cs
   ls Data/SeedData.cs
   ```

4. **Setup middleware configured**:
   ```bash
   grep -E "(IsSetupCompleteAsync|/setup)" Program.cs
   ```

5. **Seed data in development**:
   ```bash
   grep "SeedDevelopmentDataAsync" Program.cs
   ```
</verification>

<success_criteria>
- Project compiles without errors
- SetupService checks and creates household/user
- Middleware redirects to /setup when no household exists
- FirstRunSetup.razor guides user through initial setup
- WhitelistAdmin.razor allows adding/removing users
- Home.razor shows welcome message and quick links
- SeedData creates 15 realistic recipes with ingredients (development only)
- IAsyncDisposable properly implemented on components with DbContext
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-infrastructure/01-04-SUMMARY.md`
</output>
